[tools]
node = "lts"
"npm:markdownlint-cli" = "0.47"
"npm:svgo" = "latest"
"npm:wrangler" = "4.64"
harper-cli = "latest"
pandoc = "latest"

# These tasks run from site/ context, so paths are relative
[tasks."lint:biome"]
run = "npx @biomejs/biome check"
description = "Run Biome linter"

[tasks."lint:biome:fix"]
run = "npx @biomejs/biome check --write"
description = "Run Biome with auto-fix"

[tasks."lint:md"]
run = "markdownlint --config .markdownlint.json"
description = "Run markdownlint"

[tasks."lint:md:fix"]
run = "markdownlint --config .markdownlint.json --fix"
description = "Run markdownlint with auto-fix"

[tasks.lint]
run = "npm run lint"
description = "Run all linters (Biome + tsc)"

[tasks."lint:fix"]
run = "npm run format:fix && npm run lint:fix"
description = "Auto-fix all lint issues"

[tasks."ci:install"]
run = "npm ci"
description = "Install dependencies"

[tasks."ci:deploy"]
depends = ["ci:install"]
run = "npm run deploy"
description = "Deploy the site to Cloudflare Workers"

[tasks."svg:optimize"]
usage = '''
flag "-i --input <file>" help="Input SVG file"
flag "-o --output <file>" help="Output SVG file"
flag "--pretty" default=#true help="Pretty print output"
flag "--indent <n>" default="2" help="Indentation spaces"
flag "--multipass" help="Run multiple optimization passes"
'''
run = 'svgo "${usage_input}" ${usage_pretty:+--pretty} --indent "${usage_indent}" ${usage_multipass:+--multipass} -o "${usage_output}"'
description = "Optimize an SVG file"
